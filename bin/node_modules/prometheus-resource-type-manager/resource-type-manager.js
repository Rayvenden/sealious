var Set = require("Set");
var FieldTypeManager = require("prometheus-field-type-manager");
var ResourceType = require("prometheus-resource-type");

var ResourceTypeManager = (function(){

	var all_types = new Set();
	var all_types_by_name = [];

	function resource_type_name_correct(name){
		return name.length>3 && name.indexOf(" ")==-1;
	}

	this.enforce_correct_type_name = function(type_name){
		type_name = type_name.toString();
		if(!ResourceTypeManager.typeExists(type_name)){
			throw new Error("===ResourceTypeManager error===: type `" + type_name + "` does not exist.");
		}		
	};

	/**
	 * [create description]
	 * @param  {[type]} resource_type_name
	 * @param  {[type]} fields
	 * @return {[type]}
	 */
	
	this.create = function(resource_type_name, fields){
		if(!resource_type_name_correct(resource_type_name)){
			throw new Error("===ReourceManager Error:===\tincorrect resource type name: " + resource_type_name.toString());
		}
		var new_resource = new ResourceType(resource_type_name, fields);
		all_types.add(new_resource);
		all_types_by_name[resource_type_name] = new_resource;
	}

	this.getByName = function(resource_type_name){
		return all_types_by_name[resource_type_name] || null;
	};

	this.typeExists = function(resource_type_name){
		return all_types_by_name[resource_type_name]!==undefined;
	};

	return this;
})();

module.exports = ResourceTypeManager;