var sha1 = require("sha1");
var microtime = require("microtime");

module.exports = function(session_manager){
	var session_id_to_username = {};
	//póki co hashe sesji sa trzymane tylko w RAMie. Być może trzeba będzie je trzymac w pliku (albo w plikach!) na dysku.

	function generate_session_id(){
		var seed = microtime.now().toString() + Math.random()*9999999.toString();
		var session_id = sha1(seed);
		return session_id;
	}

	function new_session(username){
		var session_id = generate_session_id();
		session_id_to_username[session_id] = username;
		return session_id;
	}

	function kill_session(session_id){
		delete session_id_to_username[session_id];
	}

	session_manager.new_session = new_session;
	session_manager.kill_session = kill_session;
}