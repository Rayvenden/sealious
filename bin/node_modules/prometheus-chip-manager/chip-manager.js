var fs = require("fs");
var path = require('path')
var Set = require('Set');
//var Channel = require('prometheus-channel')

var channels = {};
var channel_info = {};

var services = {};
var service_info = {};

var registred_chips = new Set();

var Core = new function(){

	this.registerChip = function(chip_name){
		registred_chips.add(chip_name);
	}

	this.registerChannel = function(id, info, body){
		channel_info[id] = info;
		channels[id] = body;
	}

	this.registerService = function(id, info, body){
		service_info[id] = info;
		services[id] = body;
	}
	
	this.chipIsRegistred = function(chip_name){
		return registred_chips.has(chip_name);
	}

	this.getChannel = function(id){
		return channels[id];
	}

	this.getService = function(id){
		return services[id] || null;
	}

	this.getServices = function(){
		return services;
	}
}


module.exports = Core;
//!!important! export Core before importning Modules (circular dependency fail)
Modules = require("prometheus-module-manager");

